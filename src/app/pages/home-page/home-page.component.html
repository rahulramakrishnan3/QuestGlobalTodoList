<section class="home-page">
  <div class="home-card">
    <h1>Home Page</h1>
    <p>
      Welcome, <strong>{{ username }}</strong> This is your home page. Here you can manage your
      todos and keep track of your tasks for the day.
    </p>
    <div class="todo-input">
      <label for="todoTitle">New Todo</label>
      <div class="todo-input-row">
        <input
          id="todoTitle"
          type="text"
          placeholder="What do you need to do today?"
          autocomplete="off"
          [(ngModel)]="newTaskTitle"
          (keyup.enter)="addTask()"
          [ngModelOptions]="{ standalone: true }"
        />
        <input
          class="eta-input"
          type="datetime-local"
          [(ngModel)]="newTaskEta"
          [ngModelOptions]="{ standalone: true }"
        />
        <button type="button" class="add-btn" (click)="addTask()">Add</button>
      </div>
    </div>

    <section class="todo-list">
      <h2>Task List</h2>

      @if (!todos.length) {
        <p class="empty-state">No tasks yet. Add one to get started.</p>
      } @else {
        <ul>
          @for (todo of todos; track todo.id) {
            <li class="todo-item">
              @if (editingTodoId === todo.id) {
                <div class="todo-edit-row">
                  <input
                    type="text"
                    [(ngModel)]="editTaskTitle"
                    (keyup.enter)="saveEdit(todo.id)"
                    [ngModelOptions]="{ standalone: true }"
                  />
                  <input
                    class="eta-input"
                    type="datetime-local"
                    [(ngModel)]="editTaskEta"
                    [ngModelOptions]="{ standalone: true }"
                  />
                  <button type="button" class="save-btn" (click)="saveEdit(todo.id)">Save</button>
                  <button type="button" class="cancel-btn" (click)="cancelEdit()">Cancel</button>
                </div>
              } @else {
                <div class="todo-view-row">
                  <div class="todo-content">
                    <span class="todo-title">{{ todo.title }}</span>
                    <small class="todo-eta">ETA: {{ formatEta(todo.eta) }}</small>
                  </div>
                  <div class="actions">
                    <button type="button" class="edit-btn" (click)="startEdit(todo)">Edit</button>
                    <button type="button" class="delete-btn" (click)="deleteTask(todo.id)">Delete</button>
                  </div>
                </div>
              }
            </li>
          }
        </ul>
      }
    </section>
    <button type="button" class="logout-btn" (click)="logout()">Logout</button>
  </div>
</section>
